---
sidebar_position: 3
---

import { Method } from '@site/src/components/ui/method';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@site/src/components/ui/tabs';

# Records

In Collect, you have the capability to store meaningful data within **Records**. These **Records** consist of individual data
pieces, each containing keys and their corresponding values - **Properties**.


## How it works

Consider a **Record** as a row in a database, with each **Property** being like a column. Though the inner implementation may involve
complex graph structures, at its core, a **Record** is just an object that holds simple keys and values. You can think of
it as a "dictionary", "map", "hash table", or "associative array" depending on your programming language or context.

<div className="grid xl:grid-cols-5 grid-cols-1 gap-8">
  <div className="col-span-3">
    ### Typescript Definition

    ```typescript
    type MaybeArray<T> = T | T[]
    type PropertyType = "number" | "string" | "boolean" | "datetime" | "null"

    type CollectRecord = {
      // autogenerated UUIDv7
      __id: string

      // optional Record label (Order, User, Route, ...)
      __label?: string

      // autogenerated map of Record's properties types
      __proptypes: Record<string, PropertyType>

      // Record's own properties
      [key?: string]: MaybeArray<number | string | null | boolean>
    }
    ```
  </div>
  <div  className="xl:order-last col-span-2">
    ### Example
    ```javascript
    {
      "__id": "0191b44a-c815-7d40-bf48-b2d1727670d7",
      "__label": "ORDER",
      "__proptypes": {
        "items": "number",
        "sum": "number",
        "promocode": "string",
        "confirmed": "boolean",
        "createdAt": "datetime"
      },
      "items": 5,
      "sum": 232,
      "promocode": "3heg09j",
      "confirmed": true,
      "createdAt": "2024-09-02T19:22:21+0000"
    }
    ```
  </div>
</div>

---

## Create Record
<div className="grid xl:grid-cols-5 grid-cols-1 gap-8">
  <div  className="xl:order-last col-span-2">
    ### Endpoints
    Create single [Record](/core-concepts/records)
    ```ts
    POST /api/v1/records
    ```
    Create single [Record](/core-concepts/records) related to specific Record
    ```ts
    POST /api/v1/records/:id
    ```
    :::info
    Note: New Record will be created with a default incoming Relation from the Record provided in the `:id` parameter.
    :::
  </div>
  <div className="col-span-3">
    To create Record in Collect simply pass one-level object to `.create` method or through the REST API in `body`.

    ### Request

    <Tabs defaultValue="sdk" >
      <TabsList className="grid w-full grid-cols-2">
        <TabsTrigger value="sdk">SDK</TabsTrigger>
        <TabsTrigger value="api">API</TabsTrigger>
      </TabsList>
      <TabsContent value="sdk">
        ```typescript
        await Collect.records.create("ORDER", {
          items: 5,
          sum: 232,
          promocode: "3heg09j",
          confirmed: true,
          createdAt: "2024-09-02T19:22:21+0000"
        })
        ```
      </TabsContent>
      <TabsContent value="api">
        ```javascript
        {
          "label": "ORDER",
          "properites": [{
            "items": {
              "type": "number",
              "value": 5
            },
              "sum": {
              "type": "number",
              "value": 232
            },
              "promocode": {
              "type": "string",
              "value": "3heg09j",
            },
              "confirmed": {
              "type": "boolean",
              "value": true,
            },
              "createdAt": {
              "type": "datetime",
              "value": "2024-09-02T19:22:21+0000",
            },
          }]
        }
        ```
      </TabsContent>
    </Tabs>

    ### Response

    ```javascript
    // CollectRecord
    {
      "__id": "0191b44a-c815-7d40-bf48-b2d1727670d7",
      "__label": "ORDER",
      "__proptypes": {
        "items": "number",
        "sum": "number",
        "promocode": "string",
        "confirmed": "boolean",
        "createdAt": "datetime"
      },
      "items": 5,
      "sum": 232,
      "promocode": "3heg09j",
      "confirmed": true,
      "createdAt": "2024-09-02T19:22:21+0000"
    }
    ```
  </div>
</div>

---

## Get Record
<div className="grid xl:grid-cols-5 grid-cols-1 gap-8">
  <div  className="xl:order-last col-span-2">
    ### Endpoint
    Get single [Record](/core-concepts/records)
    ```ts
    GET /api/v1/records/:id
    ```
    :::info
    Note: Replace `:id` with the actual ID of the Record you want to retrieve.
    :::
  </div>
  <div className="col-span-3">
    To retrieve a Record in Collect, use the `.get` method or make a GET request to the REST API endpoint.

    ### Request

    <Tabs defaultValue="sdk" >
      <TabsList className="grid w-full grid-cols-2">
        <TabsTrigger value="sdk">SDK</TabsTrigger>
        <TabsTrigger value="api">API</TabsTrigger>
      </TabsList>
      <TabsContent value="sdk">
        ```typescript
        const record = await Collect.records.get("0191b44a-c815-7d40-bf48-b2d1727670d7")
        ```
      </TabsContent>
      <TabsContent value="api">
        ```bash
        GET /api/v1/records/0191b44a-c815-7d40-bf48-b2d1727670d7
        ```
      </TabsContent>
    </Tabs>

    ### Response

    ```javascript
    // CollectRecord
    {
      "__id": "0191b44a-c815-7d40-bf48-b2d1727670d7",
      "__label": "ORDER",
      "__proptypes": {
        "items": "number",
        "sum": "number",
        "promocode": "string",
        "confirmed": "boolean",
        "createdAt": "datetime"
      },
      "items": 5,
      "sum": 232,
      "promocode": "3heg09j",
      "confirmed": true,
      "createdAt": "2024-09-02T19:22:21+0000"
    }
    ```
  </div>
</div>

---

## Relations
<div className="grid xl:grid-cols-5 grid-cols-1 gap-8">
  <div  className="xl:order-last col-span-2">
    ### Endpoint
    Get list of all parents of Record's Relations
    ```ts
    GET /api/v1/records/:id/relations
    ```
    :::info
    Note: Replace `:id` with the actual ID of the Record whose relations you want to retrieve.
    :::
  </div>
  <div className="col-span-3">
    To retrieve the Relations of a Record in Collect, use the `.getRelations` method or make a GET request to the REST API endpoint.

    ### Request

    <Tabs defaultValue="sdk" >
      <TabsList className="grid w-full grid-cols-2">
        <TabsTrigger value="sdk">SDK</TabsTrigger>
        <TabsTrigger value="api">API</TabsTrigger>
      </TabsList>
      <TabsContent value="sdk">
        ```typescript
        const relations = await Collect.records.getRelations("0191b44a-c815-7d40-bf48-b2d1727670d7")
        ```
      </TabsContent>
      <TabsContent value="api">
        ```bash
        GET /api/v1/records/0191b44a-c815-7d40-bf48-b2d1727670d7/relations
        ```
      </TabsContent>
    </Tabs>

    ### Response

    ```javascript
    [
      {
        "__id": "0191b44a-c815-7d40-bf48-b2d1727670d8",
        "__label": "USER",
        // ... other properties of the related record
      },
      {
        "__id": "0191b44a-c815-7d40-bf48-b2d1727670d9",
        "__label": "PRODUCT",
        // ... other properties of the related record
      }
      // ... more related records
    ]
    ```
  </div>
</div>

---

## Update Record
<div className="grid xl:grid-cols-5 grid-cols-1 gap-8">
  <div  className="xl:order-last col-span-2">
    ### Endpoint
    Update single [Record](/core-concepts/records)
    ```ts
    PATCH /api/v1/records/:id
    ```
    :::info
    Note: Replace `:id` with the actual ID of the Record you want to update.
    :::
  </div>
  <div className="col-span-3">
    To update a Record in Collect, use the `.update` method or make a PATCH request to the REST API endpoint.

    ### Request

    <Tabs defaultValue="sdk" >
      <TabsList className="grid w-full grid-cols-2">
        <TabsTrigger value="sdk">SDK</TabsTrigger>
        <TabsTrigger value="api">API</TabsTrigger>
      </TabsList>
      <TabsContent value="sdk">
        ```typescript
        await Collect.records.update("0191b44a-c815-7d40-bf48-b2d1727670d7", {
          sum: 250,
          confirmed: false
        })
        ```
      </TabsContent>
      <TabsContent value="api">
        ```javascript
        {
          "properties": {
            "sum": {
              "type": "number",
              "value": 250
            },
            "confirmed": {
              "type": "boolean",
              "value": false
            }
          }
        }
        ```
      </TabsContent>
    </Tabs>

    ### Response

    ```javascript
    // Updated CollectRecord
    {
      "__id": "0191b44a-c815-7d40-bf48-b2d1727670d7",
      "__label": "ORDER",
      "__proptypes": {
        "items": "number",
        "sum": "number",
        "promocode": "string",
        "confirmed": "boolean",
        "createdAt": "datetime"
      },
      "items": 5,
      "sum": 250,
      "promocode": "3heg09j",
      "confirmed": false,
      "createdAt": "2024-09-02T19:22:21+0000"
    }
    ```
  </div>
</div>

---

## Delete Records
<div className="grid xl:grid-cols-5 grid-cols-1 gap-8">
  <div  className="xl:order-last col-span-2">
    ### Endpoint
    Delete single [Record](/core-concepts/records)
    ```ts
    DELETE /api/v1/records/:id
    ```
    :::info
    Note: Replace `:id` with the actual ID of the Record you want to delete.
    :::
  </div>
  <div className="col-span-3">
    To delete a Record in Collect, use the `.delete` method or make a DELETE request to the REST API endpoint.

    ### Request

    <Tabs defaultValue="sdk" >
      <TabsList className="grid w-full grid-cols-2">
        <TabsTrigger value="sdk">SDK</TabsTrigger>
        <TabsTrigger value="api">API</TabsTrigger>
      </TabsList>
      <TabsContent value="sdk">
        ```typescript
        await Collect.records.delete("0191b44a-c815-7d40-bf48-b2d1727670d7")
        ```
      </TabsContent>
      <TabsContent value="api">
        ```bash
        DELETE /api/v1/records/0191b44a-c815-7d40-bf48-b2d1727670d7
        ```
      </TabsContent>
    </Tabs>

    ### Response

    ```javascript
    // Successful deletion
    {
      "success": true,
      "message": "Record successfully deleted"
    }
    ```
  </div>
</div>

---

## Search
<div className="grid xl:grid-cols-5 grid-cols-1 gap-8">
  <div  className="xl:order-last col-span-2">
    ### Endpoints
    Search from root:
    ```ts
    POST /api/v1/records/search
    ```
    Search from specific Record:
    ```ts
    POST /api/v1/records/:id/search
    ```
    :::info
    Note: When searching from a specific Record, replace `:id` with the actual ID of the Record you want to start the search from.
    :::
  </div>
  <div className="col-span-3">
    To search for Records in Collect, use the `.search` method or make a POST request to the REST API endpoint.

    ### Request

    <Tabs defaultValue="sdk" >
      <TabsList className="grid w-full grid-cols-2">
        <TabsTrigger value="sdk">SDK</TabsTrigger>
        <TabsTrigger value="api">API</TabsTrigger>
      </TabsList>
      <TabsContent value="sdk">
        ```typescript
        const results = await Collect.records.search({
          label: "ORDER",
          properties: {
            sum: { $gt: 200 }
          }
        })
        ```
      </TabsContent>
      <TabsContent value="api">
        ```javascript
        {
          "label": "ORDER",
          "properties": {
            "sum": { "$gt": 200 }
          }
        }
        ```
      </TabsContent>
    </Tabs>

    ### Response

    ```javascript
    [
      {
        "__id": "0191b44a-c815-7d40-bf48-b2d1727670d7",
        "__label": "ORDER",
        "sum": 250,
        // ... other properties
      },
      // ... more matching records
    ]
    ```
  </div>
</div>

---

## Labels

<div className="grid xl:grid-cols-5 grid-cols-1 gap-8">
  <div  className="xl:order-last col-span-2">
    ### Endpoints
    Create or update a Label:
    ```ts
    POST /api/v1/label
    ```
    Get Label details:
    ```ts
    GET /api/v1/label/{labelName}
    ```
    :::info
    Note: Replace `{labelName}` with the actual name of the Label you want to retrieve.
    :::
  </div>
  <div className="col-span-3">
    Labels in Collect allow you to categorize and organize your Records. You can create, update, and retrieve Label information using these endpoints.

    ### Create or Update Label

    <Tabs defaultValue="sdk" >
      <TabsList className="grid w-full grid-cols-2">
        <TabsTrigger value="sdk">SDK</TabsTrigger>
        <TabsTrigger value="api">API</TabsTrigger>
      </TabsList>
      <TabsContent value="sdk">
        ```typescript
        await Collect.labels.createOrUpdate("ORDER", {
          description: "Represents a customer order",
          properties: {
            sum: { type: "number", required: true },
            items: { type: "number", required: true },
            status: { type: "string", enum: ["pending", "shipped", "delivered"] }
          }
        })
        ```
      </TabsContent>
      <TabsContent value="api">
        ```javascript
        POST /api/v1/label

        {
          "name": "ORDER",
          "description": "Represents a customer order",
          "properties": {
            "sum": { "type": "number", "required": true },
            "items": { "type": "number", "required": true },
            "status": { "type": "string", "enum": ["pending", "shipped", "delivered"] }
          }
        }
        ```
      </TabsContent>
    </Tabs>

    ### Get Label Details

    <Tabs defaultValue="sdk" >
      <TabsList className="grid w-full grid-cols-2">
        <TabsTrigger value="sdk">SDK</TabsTrigger>
        <TabsTrigger value="api">API</TabsTrigger>
      </TabsList>
      <TabsContent value="sdk">
        ```typescript
        const labelDetails = await Collect.labels.get("ORDER")
        ```
      </TabsContent>
      <TabsContent value="api">
        ```bash
        GET /api/v1/label/ORDER
        ```
      </TabsContent>
    </Tabs>

    ### Response

    ```javascript
    {
      "name": "ORDER",
      "description": "Represents a customer order",
      "properties": {
        "sum": { "type": "number", "required": true },
        "items": { "type": "number", "required": true },
        "status": { "type": "string", "enum": ["pending", "shipped", "delivered"] }
      },
      "recordCount": 1250  // Number of Records with this Label
    }
    ```
  </div>
</div>

---

# Import API

## Overview
The Import API allows you to push data and get it automatically normalized and labeled. This API is designed to receive
`JSON`, `CSV`, `YML` and `XML` payloads and normalize the incoming data while optionally generating labels and suggesting
[data types](/core-concepts/data-types) for each field within the payload.

### Endpoint URLs
```bash
POST /api/v1/import/json
```
```bash
POST /api/v1/import/csv
```

## Request

### Request Headers
- Content-Type: application/json

### Request Body
- The request body must be a JSON object conforming to the following Data Transfer Object (DTO):

```json
{
"parentId": "string (optional)",
  "payload": {
  "field1": "value1",
    "field2": "value2"
},
"label": "string (optional)",
  "options": {
  "generateLabels": true/false,
    "suggestTypes": true/false
}
}
```

#### Request Parameters
- `parentId` (optional): A string identifier for grouping related payloads together. Useful for organizing data hierarchically.
- `payload`: The JSON data that you want to collect, normalize, and label.
- `label` (optional): A custom label for the payload. If not provided, labels can be generated automatically based on the keys within the payload.
- `options`: An object containing options for data processing.
- `generateLabels`: A boolean flag indicating whether to generate labels automatically based on keys that hold nested objects within the payload.
- `suggestTypes`: A boolean flag indicating whether to suggest data types (e.g., boolean, number, string, datetime, null) based on the values within the payload.

## Response

### Success Response (200 OK)
- The API will respond with a JSON object containing the normalized and labeled data, along with a unique identifier for the collected data.

```json
{
"dataId": "string (unique identifier)",
  "normalizedPayload": {
  "field1": "normalized_value1",
    "field2": "normalized_value2",
...
},
"label": "string (provided or generated label)",
  "dataTypes": {
  "field1": "string (suggested data type)",
    "field2": "string (suggested data type)",
...
}
}
```

### Error Responses
- If the request is invalid or encounters an error, the API will respond with an appropriate error message along with the corresponding HTTP status code.

```json
{
"error": "string (error message)"
}
```

## Example

### Request Example
```http
POST /api/v1/collect/json
Content-Type: application/json

{
"parentId": "parent_id_123",
  "payload": {
  "name": "John Doe",
    "age": 30,
    "email": "johndoe@example.com"
},
"label": "User Data",
  "options": {
  "generateLabels": true,
    "suggestTypes": true
}
}
```

### Response Example (200 OK)
```json
{
"dataId": "data_id_456",
  "normalizedPayload": {
  "name": "John Doe",
    "age": 30,
    "email": "johndoe@example.com"
},
"label": "User Data",
  "dataTypes": {
  "name": "string",
    "age": "number",
    "email": "string"
}
}
```

## Notes
- The API provides flexibility by allowing you to customize labels and enable or disable automatic label generation and data type suggestions as needed.
- The `dataId` returned in the response can be used to reference or retrieve the collected data in the future.
- Ensure that the request payload conforms to the specified JSON format to ensure successful data processing.

---

## Export API

```bash
POST /api/v1/export/csv
```

---

## Endpoints Overview
The Records API provides several endpoints for managing and interacting with Records. Here's an overview of all available endpoints in this section:
| Method | Endpoint                           | Description                                                   |
|--------|-----------------------------------|---------------------------------------------------------------|
| <Method method="POST" color="#2e8555" />   | `/api/v1/records`                  | Create a single Record                                        |
| <Method method="POST" color="#2e8555" />   | `/api/v1/records/:id`              | Create a single Record as a child of a specific Record        |
| <Method method="GET" color="#4287f5" />    | `/api/v1/records/:id`              | Retrieve a single Record                                      |
| <Method method="POST" color="#2e8555" />   | `/api/v1/records/search`           | Search for Records from the root (all data in the project)    |
| <Method method="POST" color="#2e8555" />   | `/api/v1/records/:id/search`       | Search for Records from a specific Record to its nested children |
| <Method method="PUT" color="#f5a742" />    | `/api/v1/records/:id`              | Update a single Record                                        |
| <Method method="PUT" color="#f5a742" />    | `/api/v1/records/delete`           | Delete Records by criteria                                  |
| <Method method="DELETE" color="#f54242" /> | `/api/v1/records/:id`              | Delete a single Record                                        |
| <Method method="POST" color="#2e8555" />   | `/api/v1/records/:id/properties`   | Get detailed list of Record's Properties                    |
| <Method method="GET" color="#4287f5" />    | `/api/v1/records/:id/relations`    | Get a list of Records' Relations                    |
| <Method method="POST" color="#2e8555" />   | `/api/v1/records/:id/relations`    | Create new Relations between Records                     |
| <Method method="PUT" color="#f5a742" />    | `/api/v1/records/:id/relations`    | Delete specific Records' Relations                  |

Each endpoint is designed to perform specific operations on Records, allowing you to create, read, update, delete, and search for Records within your project. The following sections provide more detailed information about each operation.
